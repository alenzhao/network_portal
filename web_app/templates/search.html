{% extends "base2.html" %}
{% block content %}
{% load static %}
{% get_static_prefix as STATIC_PREFIX %}

<script type="text/javascript">
$(function() {
    function log(message) {
             $("<div />").text(message).prependTo("#log");
             $("#log").scrollTop(0);
    }

    $("#artist").autocomplete({
        source: function( request, response ) {
                $.ajax({
                        url:      "http://localhost:8983/solr/suggest/?wt=json&json.wrf=?",
                        dataType: "jsonp",
                        data: { q: request.term
                        },
                        success: function( data ) {
                                 response( $.each(data.spellcheck['suggestions'][1]['suggestion'], function(key, value) {
                                              //console.debug("key 1: " + key);
                                              //console.debug("val 1: " + value);
				}));
                        }
                });         

        },
        minLength: 1,
        select: function (event, ui) {
		console.debug("log event, ui: " + ui.item.label);
                $("#artist").val(ui.item.label);
		log (ui.item.label ?
                       "Selected: " + ui.item.label :
                       "Nothing selected, input was " + this.value);
        }
    });

});
</script>

<div id="main" class="sub-page">
    <!--<div class="demo">-->

      <div class="ui-widget">
	<h1>Search</h1>
	<form action="/search/" method="get">
	  <input type="text" name="q" id="artist">
	  <input type="submit" value="Search">
	</form>
	
	<!--	<label for="artist">Search: </label>
		<input id="artist" />
	-->
      </div>
      
      <!--      <div class="ui-widget" style="margin-top:2em; font-family:Arial">
	Result:
	<div id="log" style="height: 200px; width: 300px; overflow: auto;" class="ui-widget-content"></div>
      </div>
      -->

<!--      <div class="ui-widget" style="margin-top:2em; font-family:Arial">-->
        <div id="search-results">
	{% if results %}
	<h3>Search Results</h3>
	<!--<div class="ui-widget-content">-->
	  <p>Found {{ results|length }} results for "{{ q }}".</p>
	  <ul>
	    {% for result in results %}
	    <li><a href="/bicluster/{{ result.bicluster_id }}">bicluster {{ result.bicluster_id }}</a></li>
	    {% endfor %}
	    <li><a href="/network/test/">test network</a></li>
	  </ul>
	  <p><a href="/network?biclusters={{ bicluster_ids|join:"," }}">view network</a></p>
	  {% endif %}
	<!--</div>-->
      </div>
      
    <!-- </div><!-- End demo -->
</div><!-- End #main -->
{% endblock %}
