{% extends "base2.html" %}
{% block title %}Network Portal - Analysis Example{% endblock %}
{% load static %}
{% get_static_prefix as STATIC_PREFIX %}
{% block cssspecial %}<link rel="stylesheet" href="{{ STATIC_PREFIX }}stylesheets/redmond/jquery-ui-1.8.16.custom.css">{% endblock %}
{% block jsspecial %}
  <script type="text/javascript" src="{{ STATIC_PREFIX }}javascripts/main.js"></script>
  <script type="text/javascript" src="{{ STATIC_PREFIX }}cytoscapeweb/js/AC_OETags.min.js"></script>
  <script type="text/javascript" src="{{ STATIC_PREFIX }}cytoscapeweb/js/cytoscapeweb.min.js"></script>
  <script type="text/javascript" src="{{ STATIC_PREFIX }}javascripts/wwu_logo/isblogo.js"></script>
  <script type="text/javascript" src="{{ STATIC_PREFIX }}javascripts/network_helpers.js"></script>
  <script type="text/javascript" src="http://cdn.wijmo.com/jquery.wijmo-open.1.5.0.min.js"></script>

{% endblock %}
{% block content %}

<script type="text/javascript">

    var div_id = "cytoscapeweb";
    var div_id2 = "cytoscapeweb2";

    var options = {
        // where you have the Cytoscape Web SWF
        swfPath: "{{ STATIC_PREFIX }}cytoscapeweb/swf/CytoscapeWeb",
        // where you have the Flash installer SWF
        flashInstallerPath: "{{ STATIC_PREFIX }}cytoscapeweb/swf/playerProductInstall",
        flashAlternateContent: "Cytoscape Web network viewer requires Flash."
    };

    var vis = new org.cytoscapeweb.Visualization(div_id, options);
    var vis_2 = new org.cytoscapeweb.Visualization(div_id2, options);

    var flag = "false";
    var lookup = new Array();
    // callback when Cytoscape Web has finished drawing
    vis.ready(function() {

        $select_toggle = 1;
        $init = 1;
        filter_expand_network(flag);


        $node_info = vis.addListener("select", "nodes", function(event) {
            if($select_toggle == 0) {
                return;
            } 
            $dialog = $("#note").wijdialog({
                autoOpen: true,
                title: 'Selection: Nodes',
                width: 600,
                open: handle_select(event)
            });
            
        });

        $node_info = vis.addListener("click", "edges", function(event) {
            $dialog = $("#note").wijdialog({
                autoOpen: true,
                title: 'Selection: Edges',
                open: handle_click(event)
            });
        });


        // CONTROL OF THE DIALOG BOXES FOR LOOKING AT INDIVIDUAL NODES/EDGES
        // http://stackoverflow.com/questions/4518889/jquery-ui-dialog-open-multiple-dialog-boxes-using-the-same-class-on-the-button-an
        jQuery(function($) {
            $($node_info).each(function() {
                $.data(this, 'dialog', 
                    $(this).next("#note").dialog({
                        autoOpen: false,
                        width: 600
                    })
                );
            }).click(function() {
                $.data(this, 'dialog').dialog('open');
                return false;
            });
        });
    

        // START OF RIGHT CONTEXT MENU CODE - SELECT FIRST NEIGHBORS
        vis.addContextMenuItem("Select first neighbors", "nodes", 
            function (evt) {
                $select_toggle = 0;
                // Get the right-clicked node:
                var rootNode = evt.target;
        
                // Get the first neighbors of that node:
                var fNeighbors = vis.firstNeighbors([rootNode]);
                var neighborNodes = fNeighbors.neighbors;
        
                // Select the root node and its neighbors:
                vis.select([rootNode]).select(neighborNodes);

                $select_toggle = 1;
            }
        );

        // START OF FILTER CODE FOR **SHOWING** FIRST NEIGHBORS FOR AND-GATE
        vis.addContextMenuItem("AND-GATES: Show first neighbors", "nodes",
            function (evt) {
                var rootNode = evt.target;
                var logic_1 = rootNode.data["logic.combines.1"]
                var logic_2 = rootNode.data["logic.combines.2"]

	        vis.filter("nodes", function(node) {
                    // return the AND-GATE neighbors
                    if (node.data.label == rootNode.data["logic.combines.1"]) {
                        lookup[node.data.id] = "true";
                    }
                    if (node.data.label == rootNode.data["logic.combines.2"]) {
                        lookup[node.data.id] = "true";
                    }
                    return lookup[node.data.id] == "true";
	        });
            }
        );

        // START OF FILTER CODE FOR **HIDING** FIRST NEIGHBORS FOR AND-GATE
        vis.addContextMenuItem("AND-GATES: Hide first neighbors", "nodes",
            function (evt) {
                var rootNode = evt.target;
                var logic_1 = rootNode.data["logic.combines.1"];
                var logic_2 = rootNode.data["logic.combines.2"];

                vis.filter("nodes", function(node) {
                    if (node.data.label == logic_1) {
                       lookup[node.data.id] = "false";
                    }
                    if (node.data.label == logic_2) {
                       lookup[node.data.id] = "false";
                    }

                    return lookup[node.data.id] == "true";

                });
            }
        );

	$('#filter :checkbox').click(function() {
	    var $this = $(this);
	    if ($this.is(':checked')) {
                var flag = "true";
		filter_expand_network(flag);
	    } else {
                var flag = "false";
		filter_expand_network(flag);
	    }

        });

	function filter_expand_network(flag) {
	    vis.filter("nodes", function(node) {
		if (flag == "true") {
		    // return the whole network
		    lookup[node.data.id] = "true";
		    return lookup[node.data.id] == "true";
		} else {
                    // only return the core network
		    if ($init == 1) {
       			if (node.data.neighborhood == "flagella.neighbor") {
		            lookup[node.data.id] = "false";
                        } else {
		            lookup[node.data.id] = "true";
		        }
		    } else if (node.data.neighborhood == "flagella.neighbor") {
		        lookup[node.data.id] = "false";
                    } else {
		        lookup[node.data.id] = "true";
		    }
                    return lookup[node.data.id] == "true";
		}
	    });
            $init = 0;
	}

        // EVENT HANDLER
        function handle_select(event) {

            var target = event.target;
            var table_start;
            var table_end;
            var items = {};
            clear();

            len = target.length;

            var all_genes = [];
            var all_bicl = [];
            var all_regs = [];
            var all_mots = [];
            var all_ands = [];
            for (var p in target) {
                // RENDER DIFFERENT INFO AND FORMAT FOR SINGLE ITEM VIEW
                if (len == 1) {
    	            // bicluster   
                    if(target[p].data.type == "bicluster") { 
	                svglink=target[p].data["url"];
                        svglink=svglink.replace("htmls" , "svgs").replace("html", "svgz");
                        biclname=target[p].data.canonicalName;
                        biclrename=biclname.replace("bicluster_", "");
		        print( "<b class=\"ex\">" + "Name : " + "</b>" + target[p].data.canonicalName + " | " +
		               "<b class=\"ex\">" + "Links : " + "</b>" + "<a target=_blank href=" + "/bicluster/" + biclrename + ">" + target[p].data.canonicalName + " page" + "</a>");
                        print("<iframe width=530 height=500 scrolling=no src=" + svglink + ">"  + "</iframe>"  );
                        //print("<iframe width=0 height=0 src=" + target[p].data["url"] + ">"  + "</iframe>"  );
	            }
    
	            // gene 
                    if(target[p].data.type == "gene" ) {
                        print("<b class=\"ex\">" + "Node Type : " + "</b>"+ target[p].data.type + "<p>");
                        print("<hr>");
	                print("<ul>");
                        print("<li type=\"square\">" + "<b class=\"ex\">" + "Name : " + "</b>" + "<a target=_blank href=" + "/gene/" + target[p].data.label + ">" + target[p].data.label + "</a>" +  " , " + "</b>" + target[p].data["long.name"] + "</li>" + "<p>");
                        print("<li type=\"square\">" + "<b class=\"ex\">" + "Homologs : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/fetchLocus.cgi?locus=" + target[p].data.locusId + "&disp=3" + ">" + "MicrobesOnline" + "</a>" + "</li>");
                        print("<hr>");
                        print("</ul>" + "<ul>");
                        print("<li type=\"square\">" + "<b class=\"ex\">" + "# of transposon mutants : " + "<font color=\"green\">" + "</b>"  + target[p].data.transposon + "</font>" + "<p>");
                        print("<li type=\"square\">" + "<b class=\"ex\">" + "# of co-culture mutants : " + "<font color=\"red\">" + "</b>"  + target[p].data["co-culture_mutants"] + "</font>" + "</b>" + "<p>");
                        print("<hr>");
                        print("</ul>" + "<ul>");
if (target[p].data.TIGRRoles) {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "TIGR Roles : " + "</b>"+ target[p].data.TIGRRoles + "</li>" + "<p>");
                        } else {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "TIGR Roles : " + "</b>"+ "No TIGR Roles asigned" + "</li>" + "</font>" + "<p>");
                        }

                        if (target[p].data.COG) {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "COG : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/keywordSearch.cgi?taxId=882&keyword=" + target[p].data.COG + ">" + target[p].data.COG + "</a>" + " at Microbes Online" +  "</li>" + "<p>");
                        } else {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "COG : " + "</b>"+ "No COG categories asigned" + "</li>" + "</font>" + "<p>");
                        }

                        if (target[p].data.GO) {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "GO Term(s) : " + "</b>" + "<a target=_blank href=" + "http://amigo.geneontology.org/cgi-bin/amigo/term_details?term=" + target[p].data.GO + ">" + target[p].data.GO + "</a>" +  "</li>" + "<p>");
                        } else {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "GO : " + "</b>"+ "No GO Terms asigned" + "</li>" + "</font>" + "<p>");
                        }

                        print("</ul>" + "<ul>");
    
                        if (target[p].data["pathway.2"] =="NA") {
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "KEGG Main Pathway : " + "</b>" + "No KEGG pathway assigned" + "</li>" + "</font>" + "<p>");
                        } else {
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Main Pathway : " + "</b>"+ target[p].data["pathway.0"] + "</li>" + "<p>");
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Sub Pathway 1: " + "</b>"+ target[p].data["pathway.1"] + "</li>" + "<p>");
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Sub Pathway 2: " + "</b>" + "<a id=" + "pathway" + " " + "target=_blank href=" + "http://www.genome.jp/kegg-bin/show_pathway?" + target[p].data.pathway + ">" + target[p].data["pathway.2"] + "</a>" + "<div class=tooltip>" + "</li>" + "<p>");
                        }
                    }   
    
                // regulator 
                    if(target[p].data.type == "regulator" ) {
                        print("<b class=\"ex\">" + "Node Type : " + "</b>"+ target[p].data.type + "<p>");
                        print("<hr>");
                        print("<ul>");
                        print("<li type=\"square\">" +"<b class=\"ex\">" + "Name : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/keywordSearch.cgi?taxId=882&keyword=" + target[p].data.label + ">" + target[p].data.label + "</a>" +  " , " + "</b>" + target[p].data["long.name"] + "</li>");
                        print("<li type=\"square\">" + "<b class=\"ex\">" + "Homologs : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/fetchLocus.cgi?locus=" + target[p].data.locusId + "&disp=3" + ">" + "MicrobesOnline" + "</a>" + "</li>" + "<p>");
                        print("<hr>");
                        print("</ul>" + "<ul>");

                        if (target[p].data.TIGRRoles) {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "TIGR Roles : " + "</b>"+ target[p].data.TIGRRoles + "</li>" + "<p>");
                        } else {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "TIGR Roles : " + "</b>"+ "No TIGR Roles asigned" + "</li>" + "</font>" + "<p>");
                        }

                        if (target[p].data.COG) {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "COG : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/keywordSearch.cgi?taxId=882&keyword=" + target[p].data.COG + ">" + target[p].data.COG + "</a>" + " at Microbes Online" +  "</li>" + "<p>");
                        } else {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "COG : " + "</b>"+ "No COG categories asigned" + "</li>" + "</font>" + "<p>");
                        }

                        if (target[p].data.GO) {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "GO Term(s) : " + "</b>" + "<a target=_blank href=" + "http://amigo.geneontology.org/cgi-bin/amigo/term_details?term=" + target[p].data.GO + ">" + target[p].data.GO + "</a>" +  "</li>" + "<p>");
                        } else {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "GO : " + "</b>"+ "No GO Terms asigned" + "</li>" + "</font>" + "<p>");
                        }

                        print("</ul>" + "<ul>");
                        if (target[p].data["pathway.2"] =="NA") {
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "KEGG Main Pathway : " + "</b>" + "No KEGG pathway assigned" + "</li>" + "</font>" + "<p>");
                        } else {
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Main Pathway : " + "</b>"+ target[p].data["pathway.0"] + "</li>" + "<p>");
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Sub Pathway 1: " + "</b>"+ target[p].data["pathway.1"] + "</li>" + "<p>");
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Sub Pathway 2: " + "</b>" + "<a id=" + "pathway" + " " + "target=_blank href=" + "http://www.genome.jp/kegg-bin/show_pathway?" + target[p].data.pathway + ">" + target[p].data["pathway.2"] + "</a>" + "<div class=tooltip>" + "</li>" + "<p>");
                        }

            print("</ul>" + "<ul>");
          print("<li type=\"square\">" + "<b class=\"ex\">" + "Regulation : " + "</b>" + "<a target=_blank href=" + "http://regtransbase.lbl.gov/cgi-bin/regtransbase?page=geneinfo;locusid=" + target[p].data.locusId + ">" + "RegTransBase" + "</a>" + "</li>" + "<p>");

                    }
 
                // motif   
                    if(target[p].data.type == "motif") { 
                        print("<b class=\"ex\">" + "Type : " + "</b>"+ target[p].data.type + "<p>");
                        print("<ul>");
                        print( "<li>" + "<b class=\"ex\">" + "Name : " + "</b>" + target[p].data.canonicalName + "</li>" + "<p>");
                        print( "<li>" + "<b class=\"ex\">" + "Consensus : " + "</b>"  + target[p].data.consensus + "</li><li>" +
                               "<b class=\"ex\">" + "E value : " + "</b>" + target[p].data["e.value"] + "</li><li>" + 
                               "<b class=\"ex\">" + "# of Sites : " + "</b>" + target[p].data["n.sites"] + "<p>" + "</li><hr>" +
                               "<a target=_blank href=" + target[p].data.imgURL + ">" + "<img align=left src=" + target[p].data.imgURL + ">" + "</a>");
                        print("</li></ul>");
                    }
                           
            // edge   
                    if(event.group == "edges") { 
                        print("<ul>");
          print( "<b class=\"ex\">" + "Name : " + "</b>" + target[p].data.canonicalName + "<p>");

            if (target[p].data.interaction=="motif"){
                            print("<ul>" + "<b class=\"ex\">" + "E value : " + "</b>" + target[p].data["e.value"] + "</li><li>" + 
                                  "<b class=\"ex\">" + "# of Sites : " + "</b>" + target[p].data.nsites + "</li><li>" +
                                  "<b class=\"ex\">" + "Llr : " + "</b>" + target[p].data.llr +  "</li><li>" +
                                  "<b class=\"ex\">" + "Width : " + "</b>" + target[p].data.width + "<li></ul>" + "<p>" );
                        } else {
                            print("<ul>");
                            print("<hr>");

                            if (target[p].data.interaction =="down-regulates"){
                                print("<b class=\"ex\">"  + "Interaction : " + "</b>" + "<font color=\"green\">"+ target[p].data.interaction + "</font>" + "<p>");
                            }

                            if (target[p].data.interaction =="up-regulates"){
                                print("<b class=\"ex\">"  + "Interaction : " + "</b>" + "<font color=\"red\">"+ target[p].data.interaction + "</font>" + "<p>");
                            }

                            if (target[p].data.interaction =="combines"){
                                print("<b class=\"ex\">"  + "Interaction :  "<p>");
                            }

                            if (target[p].data.weight){
                                print("<ul>");
                                print( "<b class=\"ex\">" + "Inferelator Weight : " + "</b>" + target[p].data.weight + "<p>");
                            }
	                      }
                    }
            
	                  //AND-GATE
                    if(target[p].data["logic.gate"]) {
                        print("<b class=\"ex\">" + "Type : " + "</b>"+ "Logic gate" + "<p>");
                        print("<ul>");
                        print("<li>" + "<b class=\"ex\">" + "Name : " + "</b>" + target[p].data.canonicalName + "</li></ul>" + "<p                  
																               var gene_data = {};
																               var reg_data = {};
																               var mot_data = {};
																               var and_data = {};

																               var bi_array = [];
																               var gene_array = [];
																               var reg_array = [];
																               var mot_array = [];
																               var and_array = [];


																               // bicluster   
                    if(target[p].data.type== "bicluster") { 
																                   bi_data["Name"] = target[p].data.canLong Name"] = target[p].data["long.name"];
																											                       gene_data["COG"] = target[p].data.COG;
																															      mot_data["E Value"] = target[p].data["e.value"];   
																																					                    mot_data["Consensus"] = target[p].data.consensus;
																																										                mot_array = mot_data;
																																												                all_mots.push(mot_array);
																																														                items["Motifs"] = all_mots; 
																																																	                  }

																																																			              // edge   
                    if(event.group == "edges") { 
					                     // not sure if this will be added/needed; placeholder
							                 }

									             //AND-GATE
                    if(target[p].data["logic.gate"]) {
						   \">Summary view of network </caption><colgroup id=\"cols\" span=\"9\"></colgroup>";
        var row_start = "<tr>";
          var row_end = "</tr>";
        var rows = "";
        var headers = "";

        for(var a in items) {
            //console.debug("type = " + a);
            a_chunk = "<tr><th>" + a + "</th></tr>";
            table_text += a_chunk;
            rows = "";
            for (var s in items[a]) {
                rows += "<tr>";
                  headers = "";
                  for (var k in items[a][s]) {
                      h_chunk = "<th>" + k + "</th>"; 
                      headers += h_chunk; 
            _text += row_start + headers + row_end;
              table_text += rows;
          }
          table_text += "</table>";
        print(table_text);

    }

        } // END handle_select

        function handle_click(event) {
            var target = event.target;
            clear();

    // bicluster   b class=\"ex\">" + "Node Type : " + "</b>"+ target.data.type + "<p>");
                print("<hr>");
                print("<ul>");
                print("<li type=\"square\">" + "<b class=\"ex\">" + "Name : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/keywordSearch.cgi?taxId=882&keyword=" + target.data.label + ">" + target.data.label + "</a>" +  " , " + "</b>" + target.data["long.name"]+"</li>");
                print("<li type=\"sqcle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "TIGR Roles : " + "</b>"+ "No TIGR Roles asigned" + "</li>" + "</font>" + "<p>");
                }

                if (target.data.COG) {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "COG : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/keywordSearch.cgi?taxId=882&keyword=" + target.data.COG + ">" + target.data.COG + "</a>" + " at Microbes Online" +  "</li>" + "<p>");
                } else {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "COG : " + "</b>"+ "No COG categories asigned" + "</li>"  else {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "GO : " + "</b>"+ "No GO Terms asigned" + "</li>" + "</font>" + "<p>");
                }

                print("</ul>" + "<ul>");
    
                if (target.data["pathway.2"] =="NA") {
                    print("<li type=\"disc\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "KEGG Main Pathway : " + "</b>" + "No KEGG pathway assigned" + "</li>" + "</font>" + "<p>");
                } else {
                    print("<li type=\"dow_pathway?" + target.data.pathway + ">" + target.data["pathway.2"] + "</a>" + "<div class=tooltip>" + "</li>" + "<p>");
                }
            }   
    
			           // regulator 
            if(target.data.type =="regulator" ) {
                print("<b class=\"ex\">" + "Node Type : " + "</b>"+ target.data.type + "<p>");
                print("<hr>");
                print("<ul>");
                print("<li type=\"square\">" +"<b class=\"ex\">" + "Name : " + "</b>" + "<a target=_blank href=" + "http://microbel>");

                if (target.data.TIGRRoles) {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "TIGR Roles : " + "</b>"+ target.data.TIGRRoles + "</li>" + "<p>");
                } else {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "TIGR Rolprint("<li type=\"circle\">" + "<b class=\"ex\">" + "GO Term(s) : " + "</b>" + "<a target=_blank href=" + "http://amigo.geneontology.org/cgi-bin/amigo/term_details?term=" + target.data.GO + ">" + target.data.GO + "</a>" +  "</li>" + "<p>");
                } else {
                    print("<li type=\"circle\">" +.data["pathway.1"] + "</li>" + "<p>");
                    print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Sub Pathway 2: " + "</b>" + "<a id=" + "pathway" + " " + "target=_blank href=" + "http://www.genome.jp/kegg-bin/show_pathway?" + target.data.pathway + ">" + target.data["pathway.2"] + "</a>" + "<div class=tooltip>" + "</li>" + "<p>");
       " + "Consensus : " + "</b>"  + target.data.consensus + "</li><li>" +
                       "<b class=\"ex\">" + "E v" + target.data.llr +  "</li><li>" +
                          "<b class=\"ex\">" + "Width : " + "</b>" + target.data.width + "<li></ul>" + "<p>" );
                } else {
                               print("<ul>");
                        print( "<b class=\"ex\">" + "Inferelator Weight : " + "</b>" + target.data.weight + "<p>");
   
    
        $select_toggle = 1;
        $init = 1;
        //filter_expand_network2(flag2);

        // add a listener for when nodes and edges are clicked
        $node_info2 = -boxes-using-the-same-class-on-the-button-an
        jQuery(function($) {
            $($node_info2).each(function() {
                $.data(this, 'dialog', 
                    $(this).next("#note2").dialog({
    eighbors:
                vis_2.select([rootNode]).select(neighborNodes);

                $select_toggle = 1;
            }
        );

        // START OF FILTER CODE FOR **SHOWING** FIRST NEIGHBORS FOR AND-GATE
        vis_2.addContextMenuItem("AND-GATES: Show first neighbors", "nodes",
            function (evt) {
                var rootNode = evt.target;
                var logic_1 = rootNode.data["logic.combines.1"]
                var logic_2 = rootNode.data["logic.combines.2"]

			               vis_2.filter("nodes", function(node) {
                    // return the AND-GATE neighbors
                    if (node.ART OF FILTER CODE FOR **HIDING** FIRST NEIGHBORS FOR AND-GATE
        vis_2.addContextMenuItem("AND-GATES: Hide first neighbors", "nodes",
            function (evt) {
                var rootNode = evt.target;
                var logic_1 = rootNode.data["logic.combines.1"];
                var logic_2 = rootNode.data["logic.combines.2"];

                vis_2.filter("nodes", function(node) {
                    if (node.data.label == logic_1) {
                       lookup2[node.data.id] = "false";
                    }
                    if (node.data.label == logic_2) {
                       lookup2[node.data.id] = "false";
                    }

                    return lookup        });


			       function filter_expand_network2(flag2) {
			           vis_2.filter("nodes", function(node) {
			       if (flag2 == "true") {
			           // return the whole network
			           lookup2[node.data.id] = "true";
			           return lookup2[node.data.id] == "true";
			       } else {
                    // only return the core network
			           if ($init == 1) {
			       if (node.data.neighborhood == "flagella.neighbor") {
			                   lookup2[node.data.id] = "false";
                        } else {
			                   lookup2[node.data.id] = "true";
			               }
			           } else if (node.data.neighborhood == lear();

            len = target.length;

            var all_genes = [];
            var all_bicl = [];
            var all_regs = [];
            var all_mots = [];
            var all_ands = [];
            for (var p in target) {
                // RENDER DIFFERENT INFO AND FORMAT FOR SINGLE ITEM VIEW
                if (len == 1) {
			                   // bicluster   
                    if(target[p].data.type == "bicluster") { 

			                       svglink=target[p].data["url"];
                        svglink=svglink.replace("htmls" , "svgs").replace("html", "svgz");
			               print( "<b class=\"ex\">" + "Name : " + "</b>" + target[p].data.canonicalName + " | " +
			                      "<b class=\"ex\">" + "Links : " + "</b>" + "<a target=_blank hrerget[p].data["url"] + ">"  + "</iframe>"  );
            }
    
            // gene 
                    if(target[p].data.type == "gene" ) {
                        print("<b class=\"ex\">" + "Node Type : " + "</b>"+ target[p].data.type + "<p>");
                        print("<hr>");
                        print("<ul>");
                        print("<li type=\"square\">" + "<b class=\"ex\">" + "Name : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/keywordSearch.cgi?taxId=882&keyword=" + target[p].data.label + ">" + target[p].data            if (target[p].data.TIGRRoles) {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "TIGR Roles : " + "</b>"+ target[p].data.TIGRRoles + "</li>" + "<p>");
                        } else {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "TIGR Roles : " + "</b>"+ "No TIGR Roles asigned" + "</li>" + "</font>" + "<p>");
                        }

                        if (target[p].data.COG) {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "COG : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/keywordSearch.cgi?taxId=882&keyword=" + target[p].data.COG + ">" + target[p].dat               }

                        if (target[p].data.GO) {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "GO Term(s) : " + "</b>" + "<a target=_blank href=" + "http://amigo.geneontology.org/cgi-bin/amigo/term_details?term=" + target[p].data.GO + ">" + target[p].data.GO + "</a>" +  "</li>" + "<p>");
                        } else {
                            print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "GO : " + "</b>"+ "No GO Terms asigned" + "</li>" + "</font>" + "<p>");
                        }

                        print("</ul>" + "<ul>");
      
                        if (target[p].data["pathway.2"] =="NA") {
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "KEGG Main Pathway : " + "</b>" + "No KEGG pathway assigned" + "</li>" + "</font>" + "<p>");
                        } else {
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Main Pathway : " + "</b>"+ target[p].data["pathway.0"] + "</li>" + "<p>");
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Sub Pathway 1: " + "</b>"+ target[p].data["pathway.1"] + "</li>" + "<p>");
                            print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Sub Pathway 2: " + "</b>" + "<a id=" + "pathway" + " " + "target=_blank href=" + "http://www.genome.jp/kegg-bin/show_pathway?" + target[p].data.pathway + ">" + target[p].data["pathway.2"] + "</a>" + "<div class=tooltip>" + "</li>" + ref=" + "http://microbesonline.org/cgi-bin/keywordSearch.cgi?taxId=882&keyword=" + target[p].data.label + ">" + target[p].data.label + "</a>" +  " , " + "</b>" + target[p].data["lo
                        if (target[p].data.COG) {
                            print("<ls=\"ex\">" + "<font color=\"gray\">" + "GO : " + "</b>"+ "No GO Terms asigned" + "</li>" + "</font>" + "<p>");
                        }
].data.pathway + ">" + target[p].data["pathway.2"] + "</a>" + "<div class=tooltip>" + "</li>" + "<p>");
                        }

          print("</ul>" + "<ul>");
          print("<li type=\"square\">" + "<b class=\"ex\">" + "Regulation : " + "</b>" + "<a target=_blank href=" + "http://regtransbase.lbl.gov/cgi-bin/regtransbase?page=geneinfo;locusid=" + target[p].data.locusId + ">" + "RegTransBase" + "</a>" + "</li>" + "<p>");

                    }
 
                // motif   
                    if(target[p].data.type == "motif") { 
                        print("<b class=\"ex\">" + "Type : " + "</b>"+ targett[p].data["e.value"] + "</li><li>" + 
                               "<b class=\"ex\">" + "# of Sites : " + "</b>" + target[p].data["n.sites"] + "<p>" + "</li><hr>" +
                               "<a target=_blank href=" + target[p].data.imgURL + ">" + "<img align=left src=" + target[p].data.imgURL + ">" + "</a>");
                        print("</li></ul>");
                    }
          +  "</li><li>" +
                                  "<b class=\"ex\">" + "Width : " + "</b>" + target[p].data.width + "<li></ul>" + "<p>" );
                        } else {
                            print("<ul>");
                            print("<hr>");

                            if (target[p].data.interaction =="down-regulates"){
                                print("<b class=\"ex\">"  + "Interaction : " + "</b>" + "<font color=\"green\">"+ target[p].data.interaction + "</font>" + "<p>");
                            }

  "</font>" + "<p>");
                            }

                            if (target[p].data.weight){
                                print("<ul>");
                                print( "<b class=\"ex\">" + "Inferelator Weight : " + "</b>" + target[p].data.weight + "<p>");
                            }
                      }
                    }
            
                  //AND-GATE
                    if(target[p].data["logic.gate"]) {
                        print("<b class=\"ex\">" + "Type : " + "</b>"+ "Logic gate" + "<p>");
                        print("<ul>");
                        print("<li>" + "<b class=\"ex\">" + "Name : " + "</b>" + target[p].data.canonicalName + "</li></ul>" + "<pdata = {};                    
																                   var gene_data = {};
																                   var reg_data = {};
																                   var mot_data = {};
																                   var and_data = {};

																                   var bi_array = [];
																                   var gene_array = [];
																                   var reg_array = [];
																                   var mot_array = [];
																                   var and_array = [];


																                   // bicluster   
                    if(target[p].data.type== "bicluster") { 
																                       bi_data["Name"] = target[p].data.canonicalName;
																                       gene_data["Long Name"] = target[p].data["long.name"];
																                       gene_data["COG"] = target[p].data.COG;
																                       gene_data["TIGR"] = target[p].data.TIGRRoles;
																                       gene_array = gene_data;
																                       all_genes.push(gene_array);
																                       items["Genes"] = all_genes; 
																                   }

                    // regulator
                    if(target[p].data.type =="regulator" ) {
																                       reg_data["Name"] = target[p].data.label;
																                       reg_data["Short Name"] = target[p].data["short.name"]nicalName;
																       mot_data["E Value"] = target[p].data["e.value"];   
																                       mot_data["Consensus"] = target[p].data.consensus;
																                       mot_array = mot_data;
																                       all_mots.push(mot_array);
																                       items["Motifs"] = all_mots; 
																                   }

																                   // edge   
                    if(event.group == "edges") { 
																                       // not sure if this will be added/needed; placeholder
																                   }

																                   //AND-GATE
                    if(target[p].data["logic.gate"]) {
																                      work-caption\">Summary view of network </caption><colgroup id=\"cols\" span=\"9\"></colgroup>";
																               var row_start = "<tr>";
																               var row_end = "</tr>";
																               var rows = "";
																               var headers = "";

																               for(var a in items) {
																                   //console.debug("type = " + a);
																                   a_chunk = "<tr><th>" + a + "</th></tr>";
																                   table_text += a_chunk;
       table_text += row_start + hea print("<b class=\"ex\">" + "Node Type : " + "</b>"+ target.data.type + "<p>");
                print("<hr>");
                print("<ul>");
                print("<li type=\"square\">" + "<b class=\"ex\">" + "Name : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-biype=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "TIGR Roles : " + "</b>"+ "No TIGR Roles asigned" + "</li>" + "</font>" + "<p>");
                }

                if (target.data.COG) {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "COG : " + "</b>" + "<a target=_blank href=" + "http://microbesonline.org/cgi-bin/keywordSearch.cgi?taxId=882&keyword=" + target.data.COG + ">" + target.data.COG + "</a>" + " at Microbes Online" +  "</li>" + "<p>");
                } else {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "COG : " + "</b>"+ "No COG c        } else {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "GO : " + "</b>"+ "No GO Terms asigned" + "</li>" + "</font>" + "<p>");
                }

                print("</ul>" + "<ul>");
				        
                if (target.data["pathway.2"] =="NA") {
                    print("<li type=\"disc\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "KEGG Main Pathway : " + "</b>" + "No KEGG pathway assigned" + "</li>" + "</font>" + "<p>");
                } else {
                    print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Main Pathway : " + "</b>"+ target.data["pathway.0"] + "</li>" + "<p>");
                    print("<li type=\"disc\">" + "<b class=\"ex\"gg-bin/show_pathway?" + target.data.pathway + ">" + target.data["pathway.2"] + "</a>" + "<div class=tooltip>" + "</li>" + "<p>")l>" + "<ul>");

                if (target.data.TIGRRoles) {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "TIGR Roles : " + "</b>"+ target.data.TIGRRoles + "</li>" + "<p>");
                } else {
                    print("<li type=\"circle\">" + "<b class=\"ex\">" + "<font color=\"gray\">" + "TIGR Roles : " + "</b>"+ "No TIGR Roles         print("<li type=\"circle\">" + "<b class=\"ex\">" + "GO Term(s) : " + "</b>" + "<a target=_blank href=" + "http://amigo.geneontology.org/cgi-bin/amigo/term"+ target.data["pathway.1"] + "</li>" + "<p>");
                    print("<li type=\"disc\">" + "<b class=\"ex\">" + "KEGG Sub Pathway 2: " + "</b>" + "<a id=" + "pathway" + " " + "target=_blank href=" + "http://www.genomes=\"ex\">" + "Consensus : " + "</b>"  + target.data.consensus + "</li><li>" +
                       "<b class=\"ex\">" + "E value : " + "</b>" + target.data["e.value"] + "</li><li>" + 
                       "<b class=\"ex\">" + "" + "</b>" + target.data.llr +  "</li><li>" +
                          "<b class=\"ex\">" + "Width : " + "</b>" + target.data.width + "<li></ul>" + "<p>" );
                } else {
                    print("<ul>");
                    print("<hr>");

                             print("<ul>");
                        print( "<b class=\"ex\">" + "Inferelator Weight : " + "</b>" + target.data.weight + "<p>");
                    }
		            }
    s: function(data){
            if (typeof data !== "string") {
                if (window.ActiveXObject) { // IE
                    data = data.xml;
                }
          if (window.ActiveXObject) { // IE
                    data = data.xml;
                }
                else {
                    data = (new XMLSerializer()).serializeToString(data);
                }
            }
            vis="expand_all">Expand All</div>
			    </div>
-->
  <div id="summary">
      <section class="summary">
	    <span class="title">Summary:</span>
	        <span class="descr-info">Some definition/summary info here.  Wster</th>
    <th>p-value</th>
      <th>pathway 2</th>
        <th>pathway 1</th>
	  <th>pathway 0</th>
	  </tr>
  <tr>
      <td>bicluster_0286</td>
        <ts">
																       <li><a href="#tab-5">Overview Network</a></li>
																       <li><a href="#tab-6">Bicluster 0286</a></li>
																       <li><a href="#tab-7">Bicluster 0184</a></li>
																       <li><a href="#tab-8">Bicluster 0125</a></li>
																       <li><a href="#tab-9">Bicluster 0022</a></li>
																             </ul>
        <div id="tab-5" class="pane">
	  <div id="cytoscapeweb">

	    </div>
	  <div id="note">
	    </div>
	  <div id="note">
	    </div>
	  <div id="note">
	    </div>
	  <div id="note">
	    </div>
	  <div id="note">
	    </div>
	  <div id="note">
	    </div>
	  <br />
	  <form id="filter">
	      <span class="title">Filters:</span>
	        <div id="filter-section">
		    <div id="filter-1">
		          <label><input type="checkbox" name="expand_netet_residual" />
			        <!--<button id="filter_residual">Filter</button>
				        <button id="reset_residual">Reset</button>-->
				    <hr> 
				        <label for="weight">edge weight:</label>
					    <input type="text" id="weight" />
					        <div id="slider-weight">
						      </div>
						    v id="cytoscapeweb2">

	</div>
<div id="note2">
  </div>
<div id="note2">
  </div>
<div id="note2">
  </div>
<div id="note2">
  </div>
<div id="note2">
  </div>
<div id="note2">
  </div>
<br />
<form id="filter2">
    <span class="title">Filters:</span>
      <div id="filter-section2">
	  <div id="filter-3">
	        <label><input type="checkbox" name="expand_network2">Expand Network</label>
		  </div>
	    <div id="filter-4">
	          <label for="residual2">bicluster residual:</label>
		      <input type="text" id="residual2" />
		          <d
			         <!--<input type="submit" value="Filter" button id="filter_weight" />-->
				     <input type="button" value="Reset" button id="reset_weight2" /> 
				         <hr> 
					     <div id="buttonpanel2" class="buttonpanel"> 
					             <label >Hide </label>
						           <br /> 
							         <input type="button" value= "Bicluster" buttonset id="hide_bicluster2" />
								       <input type="button" value= "AND-Gate" buttonset id="hide_andgate2" />
								             <input type="button" value= "Regulator" buttonset id="hide_regulator2" />
									           <input type="button" value= "Gdiv><!-- END GENE -->

      <div id="gene-2" class="pane">      
	testing
      </div><!-- END GENE -->

    </div><!-- END GENE-TABS -->
</div><!-- End #main -->
{% endblock %}
